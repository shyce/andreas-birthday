<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Andrea's Enchanting 39th Birthday</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&family=Playfair+Display:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg-gradient: radial-gradient(circle, #1a0933, #3c096c);
            --text-primary: #f8e3ff;
            --text-secondary: #d8b4e2;
            --accent-color: #ff9e6d;
            --accent-color-2: #4ecdc4;
            --event-bg: rgba(255, 255, 255, 0.1);
            --event-border: rgba(255, 255, 255, 0.2);
            --completed-opacity: 0.5;
        }

        body {
            font-family: 'Open Sans', sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            margin: 0;
            padding: 0;
            background: var(--bg-gradient);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }

        h1 {
            font-family: 'Playfair Display', serif;
            text-align: center;
            color: var(--accent-color);
            font-size: 3.5em;
            margin-bottom: 30px;
            letter-spacing: 1px;
            text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.5);
        }

        #overall-countdown {
            text-align: center;
            font-size: 2em;
            margin-bottom: 40px;
            color: var(--text-secondary);
            background-color: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(8px);
            transition: opacity 0.5s ease;
        }

        .event {
            background-color: var(--event-bg);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
            border: 1px solid var(--event-border);
            backdrop-filter: blur(5px);
        }

        .event:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
            border-color: var(--accent-color);
            filter: brightness(1.1);
        }

        .event h2 {
            color: var(--accent-color-2);
            margin-top: 0;
            font-size: 1.8em;
            font-family: 'Merriweather', serif;
            display: flex;
            align-items: center;
        }

        .event p {
            margin: 10px 0;
            color: var(--text-secondary);
            font-size: 1.1em;
            line-height: 1.6;
        }

        .event.completed {
            opacity: var(--completed-opacity);
            transition: opacity 0.3s ease;
        }

        .event.completed h2,
        .event.completed p:not(.timer) {
            text-decoration: line-through;
        }

        .event.completed .timer {
            text-decoration: none;
        }

        .timer {
            font-weight: 600;
            color: var(--accent-color);
            font-size: 1.2em;
            margin-top: 15px;
        }

        input[type="checkbox"] {
            margin-right: 15px;
            transform: scale(1.3);
        }

        label {
            cursor: pointer;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            flex: 1;
        }

        #leaves {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 0;
        }

        .leaf {
            position: absolute;
            width: 20px;
            height: 20px;
            opacity: 0.7;
            transition: opacity 0.5s ease;
        }

        footer {
            text-align: center;
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.2);
            margin-top: 40px;
            border-radius: 15px;
            box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 1;
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 2.5em;
            }

            .event {
                padding: 20px;
            }
        }
    </style>
</head>

<body>
    <div id="leaves"></div>
    <div class="container">
        <h1>Andrea's Enchanting 39th Birthday</h1>
        <div id="overall-countdown"><span id="main-timer"></span></div>
        <div id="events-container">
            <!-- Events will be dynamically added here -->
        </div>
    </div>
    <footer>
        <p>Andrea, as we celebrate another year together, I can't help but reflect on our amazing journey since that
            night at Wild Bull. From our early adventures to raising our incredible son Gabriel, you’ve been the light
            of my life. Our love continues to grow stronger, filling our days with laughter and joy. Here’s to you, the
            heart of our family, and all the beautiful moments still ahead.</p>
    </footer>
    <script src="https://unpkg.com/dayjs@1.11.10/dayjs.min.js"></script>
    <script src="https://unpkg.com/dayjs@1.11.10/plugin/duration.js"></script>
    <script src="https://unpkg.com/dayjs@1.11.10/plugin/relativeTime.js"></script>
    <script>
        const events = [
            {
                time: '2024-09-21T09:00:00',
                title: 'Autumn Sunrise Breakfast at Café Casa',
                description: 'We’ll kick off your special day with a warm and cozy breakfast at Café Casa, a lovely spot that feels like a home away from home. Picture us nestled in a corner, enjoying the smell of freshly brewed coffee and your favorite pastries while the autumn sun starts to peek through the leaves outside. It’ll be the perfect way to savor the morning and set the tone for the day ahead.'
            },
            {
                time: '2024-09-21T11:00:00',
                title: 'Fall Fashion Exploration in Downtown Kalamazoo',
                description: 'After breakfast, we’ll stroll through the charming boutiques in downtown Kalamazoo. As we wander hand in hand, we’ll take our time trying on cozy sweaters and browsing for that perfect scarf to complement the fall colors. It’ll be a delightful way to enjoy the crisp air and capture the essence of the season together, all while sharing laughter and inspiration.'
            },
            {
                time: '2024-09-21T13:30:00',
                title: 'Lunch at 600 Kitchen & Bar',
                description: 'Next, we’ll settle in for a romantic lunch at 600 Kitchen & Bar, a place known for its creative seasonal menu and inviting atmosphere. We can reminisce about our journey together over delicious dishes and toast to the moments that brought us here. I want to create a space where we can connect and share stories, savoring each bite just as much as we savor each other’s company.'
            },
            {
                time: '2024-09-21T15:30:00',
                title: 'Relaxing Spa Retreat at Centre Spa',
                description: 'You deserve a little pampering, so we’ll head to Centre Spa for a well-deserved retreat. I’ve arranged for a soothing deep tissue massage, allowing you to unwind and let go of any stress. It’ll be a peaceful escape where you can relax and recharge, and I can’t wait to see you blissfully rejuvenated afterward, ready to enjoy the rest of our day.'
            },
            {
                time: '2024-09-21T18:00:00',
                title: 'Candlelit Dinner at Rustica',
                description: 'As the sun begins to set, we’ll head to Rustica for an intimate dinner by candlelight. This cozy restaurant is perfect for us to share a meal filled with rich flavors and heartwarming conversation. I’ll have a special dessert planned to surprise you, making this moment even sweeter. It’s a chance for us to reflect on our years together while looking forward to all that’s yet to come.'
            },
            {
                time: '2024-09-21T20:30:00',
                title: 'Harvest Moon Dance at Wild Bull',
                description: 'Finally, we’ll dance the night away at Wild Bull, where our story began. The energy will be electric as we celebrate at the Harvest Moon Party, and just when we think the night can’t get any better, we’ll enjoy the late-night pizza buffet—no waiting in line! It’ll be a perfect way to reminisce about our first moments while making new memories together under the autumn stars.'
            }
        ];


        const LEAF_COUNT = 75;
        const leafPool = [];

        function manageLeafPool() {
            leafPool.forEach(leaf => {
                if (leaf.isOffScreen()) {
                    leaf.reset();
                }
            });
        }

        class Leaf {
            constructor() {
                this.element = this.createLeafElement();
                this.leafColors = [
                    '#4CAF50', '#69C550', '#86DB50', '#A3F150', '#C1F33C', '#DFF528',
                    '#FDF714', '#FDE014', '#FDC914', '#FDB214', '#FD9B14', '#FD8414',
                    '#FD6D14', '#FD5614', '#FD3F14', '#FD2814', '#E82C14', '#D33014'
                ];
                this.reset(true);
            }

            createLeafElement() {
                const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
                svg.setAttribute("viewBox", "0 0 24 24");
                svg.style.position = 'absolute';
                svg.style.width = '20px';
                svg.style.height = '20px';

                const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                path.setAttribute("d", "M17,8C8,10 5.9,16.17 3.82,21.34L5.71,22L6.66,19.7C7.14,19.87 7.64,20 8,20C19,20 22,3 22,3C21,5 14,5.25 9,6.25C4,7.25 2,11.5 2,13.5C2,15.5 3.75,17.25 3.75,17.25C7,8 17,8 17,8Z");

                svg.appendChild(path);
                document.getElementById('leaves').appendChild(svg);

                return svg;
            }

            reset(isInitial = false) {
                this.element.style.left = `${Math.random() * 100}vw`;
                this.element.style.top = '-20px';
                this.startTime = null;
                this.animationDuration = Math.random() * 15 + 20; // 20-35 seconds
                this.colorTransitionSpeed = Math.random() * 0.5 + 0.75;
                this.swayFactor = Math.random() * 100 + 50;
                this.rotationSpeed = Math.random() * 720 + 360;
                this.fallCurve = Math.random() * 0.3 + 0.7;
                this.initialDelay = isInitial ? Math.random() * 14000 + 1000 : 0; // 1-15 seconds for initial leaves, 0 for resets

                // Reset color to initial green
                this.element.querySelector('path').setAttribute('fill', this.leafColors[0]);

                this.startAnimation();
            }

            startAnimation() {
                const animate = (timestamp) => {
                    if (!this.startTime) this.startTime = timestamp;
                    let elapsed = timestamp - this.startTime;

                    if (elapsed < this.initialDelay) {
                        requestAnimationFrame(animate);
                        return;
                    }

                    let progress = (elapsed - this.initialDelay) / (this.animationDuration * 1000);

                    if (progress < 1) {
                        const adjustedProgress = Math.pow(progress, this.fallCurve);
                        const translateY = adjustedProgress * (window.innerHeight + 40);
                        const translateX = Math.sin(adjustedProgress * 4 * Math.PI) * this.swayFactor;
                        const rotate = adjustedProgress * this.rotationSpeed;

                        // Color transition
                        const colorProgress = progress * this.colorTransitionSpeed * (this.leafColors.length - 1);
                        const currentColorIndex = Math.floor(colorProgress);
                        const nextColorIndex = Math.min(currentColorIndex + 1, this.leafColors.length - 1);
                        const colorInterpolation = colorProgress % 1;

                        const currentColor = this.leafColors[currentColorIndex];
                        const nextColor = this.leafColors[nextColorIndex];
                        const interpolatedColor = this.interpolateColor(currentColor, nextColor, colorInterpolation);

                        this.element.querySelector('path').setAttribute('fill', interpolatedColor);
                        this.element.style.transform = `translate(${translateX}px, ${translateY}px) rotate(${rotate}deg)`;

                        requestAnimationFrame(animate);
                    } else {
                        this.reset();
                    }
                };

                requestAnimationFrame(animate);
            }

            isOffScreen() {
                const rect = this.element.getBoundingClientRect();
                return rect.top > window.innerHeight;
            }

            interpolateColor(color1, color2, factor) {
                if (!color1 || !color2) return color1 || color2 || '#4CAF50'; // Fallback to initial green if colors are undefined

                const r1 = parseInt(color1.substring(1, 3), 16);
                const g1 = parseInt(color1.substring(3, 5), 16);
                const b1 = parseInt(color1.substring(5, 7), 16);

                const r2 = parseInt(color2.substring(1, 3), 16);
                const g2 = parseInt(color2.substring(3, 5), 16);
                const b2 = parseInt(color2.substring(5, 7), 16);

                const r = Math.round(r1 + factor * (r2 - r1));
                const g = Math.round(g1 + factor * (g2 - g1));
                const b = Math.round(b1 + factor * (b2 - b1));

                return `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1)}`;
            }
        }

        function createEventElement(event, index) {
            const eventDiv = document.createElement('div');
            eventDiv.className = 'event';
            eventDiv.innerHTML = `
            <h2>
                <input type="checkbox" id="event-${index}" onchange="toggleComplete(${index})">
                <label for="event-${index}">${event.title}</label>
            </h2>
            <p>${event.description}</p>
            <p class="timer" id="timer-${index}"></p>
        `;
            return eventDiv;
        }

        dayjs.extend(dayjs_plugin_duration);
        dayjs.extend(dayjs_plugin_relativeTime);

        function formatTimeRemaining(distance) {
            const duration = dayjs.duration(distance);
            const days = Math.floor(duration.asDays());
            const hours = Math.floor(duration.hours());
            const minutes = Math.floor(duration.minutes());
            const seconds = Math.floor(duration.seconds());

            let timeString = [];
            if (days > 0) {
                timeString.push(`${days} day${days > 1 ? 's' : ''}`);
            }
            if (hours > 0) {
                timeString.push(`${hours} hour${hours > 1 ? 's' : ''}`);
            }
            if (minutes > 0) {
                timeString.push(`${minutes} minute${minutes > 1 ? 's' : ''}`);
            }
            if (seconds > 0) {
                timeString.push(`${seconds} second${seconds > 1 ? 's' : ''}`);
            }

            return timeString.join(', ');
        }

        function updateTimers() {
            const now = dayjs();
            events.forEach((event, index) => {
                const eventTime = dayjs(event.time);
                const distance = eventTime.diff(now);

                const eventElement = document.getElementById(`event-${index}`).closest('.event');
                const timerElement = document.getElementById(`timer-${index}`);
                const checkbox = document.getElementById(`event-${index}`);
                if (timerElement && checkbox) {
                    if (distance < 0) {
                        timerElement.innerHTML = 'This magical moment has passed!';
                        if (!checkbox.checked) {
                            checkbox.checked = true;
                            checkbox.disabled = true;
                            toggleComplete(index);
                        }
                    } else {
                        timerElement.innerHTML = `Begins ${formatTimeRemaining(distance)}`;
                    }
                }
            });

            const mainTimerElement = document.getElementById('main-timer');
            const firstEventTime = dayjs(events[0].time);
            const overallDistance = firstEventTime.diff(now);
            if (overallDistance < 0) {
                mainTimerElement.innerHTML = 'Your enchanting day has begun, Andrea!';
            } else {
                mainTimerElement.innerHTML = 'Your autumn adventure begins ' + formatTimeRemaining(overallDistance);
            }
        }

        function checkPastEvents() {
            const now = new Date().getTime();
            events.forEach((event, index) => {
                const eventTime = new Date(event.time).getTime();
                if (now > eventTime) {
                    const checkbox = document.getElementById(`event-${index}`);
                    if (checkbox && !checkbox.checked) {
                        checkbox.checked = true;
                        checkbox.disabled = true;
                        toggleComplete(index);
                    }
                }
            });
        }

        function toggleComplete(index) {
            const eventElement = document.getElementById(`event-${index}`).closest('.event');
            eventElement.classList.toggle('completed');
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Initial leaf creation
            for (let i = 0; i < LEAF_COUNT; i++) {
                leafPool.push(new Leaf());
            }

            // Set up the leaf management interval
            setInterval(manageLeafPool, 100);
            const container = document.getElementById('events-container');
            events.forEach((event, index) => {
                container.appendChild(createEventElement(event, index));
            });
            checkPastEvents(); // Check for past events on load
            updateTimers();
            setInterval(() => {
                checkPastEvents();
                updateTimers();
            }, 1000); // Update every minute
        });
    </script>
</body>

</html>